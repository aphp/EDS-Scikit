<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../../../_static/scikit_logo.svg" rel="icon"/>
<meta content="mkdocs-1.4.3, mkdocs-material-8.2.16" name="generator"/>
<title>Visit merging - eds-scikit</title>
<link href="../../../assets/stylesheets/main.1c3799f8.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.cc9b2e1e.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../../assets/_mkdocstrings.css" rel="stylesheet"/>
<link href="../../../_static/extra.css" rel="stylesheet"/>
<link href="../../../_static/cards.css" rel="stylesheet"/>
<link href="../../../_static/termynal/termynal.css" rel="stylesheet"/>
<link href="../../../css/ansi-colours.css" rel="stylesheet"/>
<link href="../../../css/jupyter-cells.css" rel="stylesheet"/>
<link href="../../../css/pandas-dataframe.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<html class="no-js" lang="en"><div class="md-container" data-md-component="container"><main class="md-main" data-md-component="main"><div class="md-main__inner md-grid"><div class="md-content" data-md-component="content"><article class="md-content__inner md-typeset"><div class="doc doc-object doc-function"><div class="doc doc-contents first" open="" style="text-align: center"><table>
<thead>
<tr>
<th><b>PARAMETER</b></th>
<th><b>DESCRIPTION</b></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>vo</code></td>
<td class="doc-param-details">
<p>The <code>visit_occurrence</code> DataFrame, with at least the following columns:
- visit_occurrence_id
- person_id
- visit_start_datetime_calc (from preprocessing)
- visit_end_datetime (from preprocessing)
Depending on the input parameters, additional columns may be required:
- care_site_id (if <code>merge_different_hospitals == True</code>)
- visit_source_value (if <code>merge_different_source_values != False</code>)
- row_status_source_value (if <code>remove_deleted_visits= True</code>)</p>
<p>
<span class="doc-param-annotation">
<b>TYPE:</b>
<code><span title="eds_scikit.utils.typing.DataFrame">DataFrame</span></code>
</span>
</p>
</td>
</tr>
<tr>
<td><code>remove_deleted_visits</code></td>
<td class="doc-param-details">
<p>Wether to remove deleted visits from the merging procedure.
Deleted visits are extracted via the <code>row_status_source_value</code> column</p>
<p>
<span class="doc-param-annotation">
<b>TYPE:</b>
<code>bool</code>
</span>
<span class="doc-param-default">
<b>DEFAULT:</b>
<code>True</code>
</span>
</p>
</td>
</tr>
<tr>
<td><code>long_stay_filtering</code></td>
<td class="doc-param-details">
<p>Filtering method for long and/or non-closed visits. First of all, visits with no starting date
won't be merged with any other visit, and visits with no ending date will have a temporary
"theoretical" ending date set by <code>datetime.now()</code>. That being said, some visits are sometimes years long
because they weren't closed at time. If other visits occurred during this timespan,
they could be all merged into the same stay. To avoid this issue, filtering can be done
depending on the <code>long_stay_filtering</code> value:</p>
<ul>
<li><code>all</code>: All long stays (closed and open) are removed from the merging procedure</li>
<li><code>open</code>: Only long open stays are removed from the merging procedure</li>
<li><code>None</code>: No filtering is done on long visits</li>
</ul>
<p>Long stays are determined by the <code>long_stay_threshold</code> value.</p>
<p>
<span class="doc-param-annotation">
<b>TYPE:</b>
<code><span title="typing.Optional">Optional</span>[str]</code>
</span>
<span class="doc-param-default">
<b>DEFAULT:</b>
<code>'all'</code>
</span>
</p>
</td>
</tr>
<tr>
<td><code>long_stay_threshold</code></td>
<td class="doc-param-details">
<p>Minimum visit duration value to consider a visit as candidate for "long visits filtering"</p>
<p>
<span class="doc-param-annotation">
<b>TYPE:</b>
<code><span title="datetime.timedelta">timedelta</span></code>
</span>
<span class="doc-param-default">
<b>DEFAULT:</b>
<code>timedelta(days=365)</code>
</span>
</p>
</td>
</tr>
<tr>
<td><code>open_stay_end_datetime</code></td>
<td class="doc-param-details">
<p>Datetime to use in order to fill the <code>visit_end_datetime</code> of open visits. This is necessary in
order to compute stay duration and to filter long stays. If not provided <code>datetime.now()</code> will be used.
You might provide the extraction date of your data here.</p>
<p>
<span class="doc-param-annotation">
<b>TYPE:</b>
<code><span title="typing.Optional">Optional</span>[<span title="datetime.datetime">datetime</span>]</code>
</span>
<span class="doc-param-default">
<b>DEFAULT:</b>
<code>None</code>
</span>
</p>
</td>
</tr>
<tr>
<td><code>max_timedelta</code></td>
<td class="doc-param-details">
<p>Maximum time difference between the end of a visit and the start of another to consider
them as belonging to the same stay. This duration is internally converted in seconds before
comparing. Thus, if you want e.g. to merge visits happening in two consecutive days, you should use
<code>timedelta(days=2)</code> and NOT <code>timedelta(days=1)</code> in order to take into account extreme cases such as
an first visit ending on Monday at 00h01 AM and another one starting at 23h59 PM on Tuesday</p>
<p>
<span class="doc-param-annotation">
<b>TYPE:</b>
<code><span title="datetime.timedelta">timedelta</span></code>
</span>
<span class="doc-param-default">
<b>DEFAULT:</b>
<code>timedelta(days=2)</code>
</span>
</p>
</td>
</tr>
<tr>
<td><code>merge_different_hospitals</code></td>
<td class="doc-param-details">
<p>Wether to allow visits occurring in different hospitals to be merged into a same stay</p>
<p>
<span class="doc-param-annotation">
<b>TYPE:</b>
<code>bool</code>
</span>
<span class="doc-param-default">
<b>DEFAULT:</b>
<code>False</code>
</span>
</p>
</td>
</tr>
<tr>
<td><code>merge_different_source_values</code></td>
<td class="doc-param-details">
<p>Wether to allow visits with different <code>visit_source_value</code> to be merged into a same stay. Values can be:</p>
<ul>
<li><code>True</code>: the <code>visit_source_value</code> isn't taken into account for the merging</li>
<li><code>False</code>: only visits with the same <code>visit_source_value</code> can be merged into a same stay</li>
<li><code>List[str]</code>: only visits which <code>visit_source_value</code> is in the provided list can be merged together.</li>
</ul>
<p><strong>Warning</strong>: You should avoid merging visits where <code>visit_source_value == "hospitalisation incomplète"</code>,
because those stays are often never closed.</p>
<p>
<span class="doc-param-annotation">
<b>TYPE:</b>
<code><span title="typing.Union">Union</span>[bool, <span title="typing.List">List</span>[str]]</code>
</span>
<span class="doc-param-default">
<b>DEFAULT:</b>
<code>['hospitalisés', 'urgence']</code>
</span>
</p>
</td>
</tr>
</tbody>
</table></div></div></article></div></div></main></div></html>